# 4-4. 차원 모델링, 단순함의 철학 🎭

## 📖 학습 목표
- 차원 모델링의 핵심 철학 이해
- 단순함이 가져다주는 가치 인식
- 차원 모델링의 기본 원칙 학습

## 🎯 차원 모델링이란?

### 정의
**차원 모델링**은 비즈니스 사용자가 이해하기 쉽고 빠른 성능을 제공하는 
데이터 웨어하우스 설계 기법으로, 단순함을 추구하는 철학을 바탕으로 합니다.

### 연극 무대와의 비유
```
연극 무대              차원 모델
─────────────────     ─────────────────
무대 (중심)        →   팩트 테이블 (중심)
배우들 (주변)      →   차원 테이블들 (주변)
스토리 (내용)      →   비즈니스 프로세스
관객 (사용자)      →   분석가/의사결정자
단순한 구성        →   직관적인 구조
```

## 🌟 단순함의 철학

### 1. 사용자 중심 설계
```
기존 정규화 모델의 문제:
❌ 복잡한 조인 (5-10개 테이블)
❌ 기술적 용어 (FK, PK, 정규화)
❌ 이해하기 어려운 구조
❌ 느린 쿼리 성능

차원 모델의 해결책:
✅ 단순한 조인 (2-3개 테이블)
✅ 비즈니스 용어 (고객, 상품, 매출)
✅ 직관적인 구조
✅ 빠른 쿼리 성능
```

### 2. 비즈니스 프로세스 중심
```
전통적 접근법:
시스템 → 테이블 → 관계 → 분석

차원 모델링 접근법:
비즈니스 → 프로세스 → 측정 → 차원
```

### 3. 성능과 이해도의 균형
```
성능 최적화:
- 비정규화를 통한 조인 최소화
- 사전 계산된 집계값
- 인덱스 최적화

이해도 향상:
- 직관적인 테이블명
- 비즈니스 용어 사용
- 명확한 관계 구조
```

## 📐 차원 모델링의 기본 구조

### 스타 스키마 (Star Schema)
```
구조:
        차원테이블A
            │
차원테이블B ── 팩트테이블 ── 차원테이블C
            │
        차원테이블D

특징:
- 중앙의 팩트 테이블
- 주변의 차원 테이블들
- 직접적인 관계 (1단계 조인)
- 별 모양의 구조
```

### 실제 예시: 매출 분석
```sql
-- 스타 스키마 구조
CREATE TABLE 매출팩트 (
    일자키 NUMBER,
    고객키 NUMBER,
    상품키 NUMBER,
    지역키 NUMBER,
    매출금액 NUMBER,
    수량 NUMBER,
    할인금액 NUMBER
);

CREATE TABLE 일자차원 (
    일자키 NUMBER PRIMARY KEY,
    일자 DATE,
    년도 NUMBER,
    분기 NUMBER,
    월 NUMBER,
    요일 VARCHAR(10)
);

CREATE TABLE 고객차원 (
    고객키 NUMBER PRIMARY KEY,
    고객ID VARCHAR(10),
    고객명 VARCHAR(50),
    고객등급 VARCHAR(20),
    연령대 VARCHAR(10)
);

-- 단순한 분석 쿼리
SELECT 
    d.년도,
    d.분기,
    c.고객등급,
    SUM(f.매출금액) as 총매출
FROM 매출팩트 f
JOIN 일자차원 d ON f.일자키 = d.일자키
JOIN 고객차원 c ON f.고객키 = c.고객키
WHERE d.년도 = 2024
GROUP BY d.년도, d.분기, c.고객등급;
```

## 🎨 차원 모델링의 핵심 개념

### 1. 팩트 (Fact)
```
정의: 비즈니스 프로세스에서 측정되는 수치

특징:
- 숫자형 데이터
- 집계 가능한 값
- 시간에 따라 변하는 값
- 분석의 대상

예시:
매출금액, 수량, 이익, 비용
고객수, 주문건수, 클릭수
재고량, 생산량, 불량률
```

### 2. 차원 (Dimension)
```
정의: 팩트를 분석하는 관점이나 기준

특징:
- 텍스트형 데이터 중심
- 분류 및 그룹핑 기준
- 상대적으로 안정적
- 계층 구조 가능

예시:
시간 (년-분기-월-일)
고객 (지역-등급-연령대)
상품 (카테고리-브랜드-모델)
지역 (국가-시도-시군구)
```

### 3. 측정값 (Measure)
```
정의: 팩트 테이블에 저장되는 구체적인 수치

유형:
가산형 (Additive):
- 모든 차원에서 합계 가능
- 예: 매출금액, 수량

반가산형 (Semi-Additive):
- 일부 차원에서만 합계 가능
- 예: 잔고, 재고량 (시간 차원 제외)

비가산형 (Non-Additive):
- 합계 불가능
- 예: 비율, 평균값
```

## 🔍 차원 모델링 설계 과정

### 1단계: 비즈니스 프로세스 선택
```
질문:
- 어떤 비즈니스 프로세스를 분석할 것인가?
- 누가 이 분석을 사용할 것인가?
- 어떤 의사결정을 지원할 것인가?

예시:
프로세스: 온라인 쇼핑몰 주문 처리
사용자: 마케팅팀, 영업팀, 경영진
목적: 매출 분석, 고객 분석, 상품 분석
```

### 2단계: 세분화 수준 결정
```
질문:
- 가장 상세한 분석 단위는 무엇인가?
- 어떤 수준의 요약이 필요한가?

예시:
상세 수준: 주문 라인별 (주문번호 + 상품코드)
요약 수준: 일별, 월별, 분기별
```

### 3단계: 차원 식별
```
질문:
- 팩트를 어떤 관점에서 분석할 것인가?
- 사용자가 자주 사용하는 분류 기준은?

예시:
시간 차원: 언제 (When)
고객 차원: 누가 (Who)  
상품 차원: 무엇을 (What)
지역 차원: 어디서 (Where)
채널 차원: 어떻게 (How)
```

### 4단계: 팩트 식별
```
질문:
- 무엇을 측정할 것인가?
- 어떤 KPI가 중요한가?

예시:
매출금액: 비즈니스 성과 측정
수량: 판매량 분석
할인금액: 프로모션 효과 분석
이익금액: 수익성 분석
```

## 💡 차원 모델링의 장점

### 1. 직관적 이해
```
사용자 관점:
"작년 4분기 VIP 고객의 전자제품 매출은?"

SQL 쿼리:
SELECT SUM(매출금액)
FROM 매출팩트 f
JOIN 일자차원 d ON f.일자키 = d.일자키
JOIN 고객차원 c ON f.고객키 = c.고객키  
JOIN 상품차원 p ON f.상품키 = p.상품키
WHERE d.년도 = 2023 AND d.분기 = 4
  AND c.고객등급 = 'VIP'
  AND p.대분류 = '전자제품';

→ 질문과 쿼리가 직관적으로 매칭됨
```

### 2. 뛰어난 성능
```
성능 최적화 요소:
- 최소한의 조인 (보통 2-4개)
- 사전 계산된 집계값
- 효율적인 인덱스 구조
- 병렬 처리 최적화

성능 비교:
정규화 모델: 8개 테이블 조인 → 10초
차원 모델: 3개 테이블 조인 → 1초
```

### 3. 확장성
```
새로운 요구사항 대응:
- 새로운 차원 추가 용이
- 새로운 팩트 추가 가능
- 기존 구조 영향 최소화

예시:
기존: 매출팩트 + 4개 차원
추가: 프로모션 차원 → 5개 차원
영향: 기존 쿼리 변경 없음
```

## 🚨 차원 모델링 시 주의사항

### 1. 과도한 비정규화 지양
```
❌ 잘못된 접근:
모든 정보를 팩트 테이블에 저장
→ 테이블 크기 급증, 성능 저하

✅ 올바른 접근:
적절한 차원 분리
→ 균형잡힌 구조, 최적 성능
```

### 2. 차원의 적절한 설계
```
❌ 너무 많은 차원:
10개 이상의 차원 → 복잡성 증가

❌ 너무 적은 차원:
2-3개 차원 → 분석 제약

✅ 적절한 차원 수:
5-8개 차원 → 균형잡힌 설계
```

### 3. 비즈니스 규칙 반영
```
고려사항:
- 데이터 품질 규칙
- 비즈니스 정의 일관성
- 예외 상황 처리
- 이력 관리 방법
```

## 🎯 실무 적용 가이드

### 성공적인 차원 모델링을 위한 체크리스트
```
설계 단계:
□ 비즈니스 프로세스가 명확한가?
□ 사용자 요구사항을 충분히 파악했는가?
□ 적절한 세분화 수준을 결정했는가?
□ 차원과 팩트가 명확히 구분되는가?

구현 단계:
□ 직관적인 테이블명을 사용했는가?
□ 성능을 고려한 인덱스를 설계했는가?
□ 데이터 품질 검증 로직이 있는가?
□ 확장성을 고려했는가?

운영 단계:
□ 사용자 교육이 충분한가?
□ 성능 모니터링 체계가 있는가?
□ 피드백 수집 및 개선 프로세스가 있는가?
□ 지속적인 최적화 계획이 있는가?
```

### 차원 모델링 성숙도 평가
```
Level 1 (기초):
- 기본 스타 스키마 구현
- 단순한 차원과 팩트 구분
- 기본적인 분석 쿼리 작성

Level 2 (중급):
- 복잡한 차원 계층 구조
- 다양한 팩트 유형 활용
- 성능 최적화 적용

Level 3 (고급):
- 고급 차원 기법 (SCD, 브리지 테이블)
- 복합 비즈니스 프로세스 모델링
- 실시간 분석 환경 구축
```

## 🎯 체크리스트: 차원 모델링 철학 이해

### 핵심 철학
- [ ] 단순함의 가치를 이해하는가?
- [ ] 사용자 중심 설계를 추구하는가?
- [ ] 비즈니스 프로세스 중심으로 접근하는가?
- [ ] 성능과 이해도의 균형을 고려하는가?

### 실무 적용
- [ ] 적절한 차원과 팩트를 식별할 수 있는가?
- [ ] 직관적인 모델을 설계할 수 있는가?
- [ ] 성능을 고려한 최적화를 할 수 있는가?
- [ ] 확장 가능한 구조를 만들 수 있는가?

---

**다음**: [4-5. 차원 모델링 용어 탐방(1): 스타 스키마, OLAP 큐브](./05-star-schema-olap.md)