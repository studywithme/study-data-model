# 4-2. 데이터 웨어하우스, 구름 타고 개념 잡기 ☁️

## 📖 학습 목표
- 데이터 웨어하우스의 기본 개념 이해
- DW의 특징과 구성 요소 파악
- 전통적 DB와의 차이점 학습

## 🎯 데이터 웨어하우스란?

### 정의
**데이터 웨어하우스(Data Warehouse)**는 의사결정을 지원하기 위해 
다양한 운영 시스템의 데이터를 수집, 통합, 저장하는 중앙 집중식 저장소입니다.

### 창고와의 비유
```
물리적 창고              데이터 웨어하우스
─────────────────       ─────────────────
다양한 공급업체     →    다양한 운영 시스템
상품 분류 및 정리   →    데이터 정제 및 통합
체계적 보관         →    구조화된 저장
필요시 출고         →    분석용 데이터 제공
재고 관리           →    이력 데이터 관리
```

## 🏗️ 데이터 웨어하우스의 특징

### 1. 주제 지향적 (Subject-Oriented)
```
특징: 비즈니스 주제별로 데이터 구성

예시:
고객 주제 영역:
- 고객 기본정보
- 고객 거래이력  
- 고객 행동패턴
- 고객 세그먼트

상품 주제 영역:
- 상품 기본정보
- 상품 판매실적
- 상품 재고현황
- 상품 수익성
```

### 2. 통합적 (Integrated)
```
특징: 여러 시스템의 데이터를 일관된 형태로 통합

통합 과정:
운영시스템A: 고객코드 = "CUST001"
운영시스템B: 회원번호 = "M001"  
운영시스템C: 거래처ID = "C001"
        ↓ 통합
데이터웨어하우스: 고객키 = 12345 (통일된 형태)
```

### 3. 시계열적 (Time-Variant)
```
특징: 시간에 따른 데이터 변화 추적

예시:
고객등급 이력:
고객키 | 등급 | 적용시작일 | 적용종료일
12345  | VIP  | 2024-01-01 | 2024-06-30
12345  | GOLD | 2024-07-01 | 2024-12-31
12345  | VIP  | 2025-01-01 | 9999-12-31

→ 시간에 따른 고객등급 변화 분석 가능
```

### 4. 비휘발성 (Non-Volatile)
```
특징: 한번 저장된 데이터는 변경되지 않음

운영 시스템:
- 실시간 입력/수정/삭제
- 현재 상태만 유지
- 이력 정보 소실

데이터 웨어하우스:
- 주기적 배치 적재
- 이력 데이터 누적 보관
- 과거 데이터 보존
```

## 📊 DW 아키텍처 구성요소

### 1. 데이터 소스 (Data Sources)
```
내부 시스템:
- ERP 시스템
- CRM 시스템  
- 주문관리 시스템
- 재고관리 시스템

외부 시스템:
- 시장조사 데이터
- 경제지표 데이터
- 소셜미디어 데이터
- 공공데이터
```

### 2. ETL 프로세스
```
Extract (추출):
- 소스 시스템에서 데이터 추출
- 증분 추출 vs 전체 추출
- 실시간 vs 배치 추출

Transform (변환):
- 데이터 정제 및 검증
- 형식 표준화
- 비즈니스 규칙 적용
- 집계 및 계산

Load (적재):
- 데이터웨어하우스에 저장
- 차원 테이블 먼저 적재
- 팩트 테이블 나중에 적재
```

### 3. 데이터 저장소
```
ODS (Operational Data Store):
- 운영 데이터의 임시 저장소
- 실시간에 가까운 데이터
- 상세 수준 데이터

DW Core (데이터웨어하우스 코어):
- 통합되고 정제된 데이터
- 이력 데이터 보관
- 스타/스노우플레이크 스키마

Data Mart (데이터 마트):
- 특정 부서/주제별 데이터
- DW에서 추출한 서브셋
- 사용자 친화적 구조
```

### 4. 분석 도구
```
리포팅 도구:
- 정형 리포트 생성
- 대시보드 제공
- 스케줄링 기능

OLAP 도구:
- 다차원 분석
- 드릴다운/롤업
- 슬라이싱/다이싱

데이터 마이닝:
- 패턴 발견
- 예측 모델링
- 고급 분석
```

## 🔄 데이터 흐름

### 전체 데이터 흐름
```
[운영시스템] → [ETL] → [ODS] → [DW Core] → [Data Mart] → [분석도구]
     ↓           ↓       ↓        ↓          ↓           ↓
  실시간 데이터  변환   임시저장  통합저장   주제별저장   분석결과
```

### 상세 ETL 프로세스
```sql
-- 1. 추출 (Extract)
SELECT 고객ID, 고객명, 주문일자, 주문금액
FROM 운영DB.주문
WHERE 주문일자 >= '2024-01-01';

-- 2. 변환 (Transform)  
-- 데이터 정제
UPDATE 임시테이블 
SET 고객명 = TRIM(고객명)
WHERE 고객명 LIKE ' %' OR 고객명 LIKE '% ';

-- 형식 통일
UPDATE 임시테이블
SET 전화번호 = REGEXP_REPLACE(전화번호, '[^0-9]', '');

-- 3. 적재 (Load)
INSERT INTO DW.매출팩트 (
    일자키, 고객키, 매출금액, 수량
)
SELECT 
    TO_NUMBER(TO_CHAR(주문일자, 'YYYYMMDD')),
    고객차원.고객키,
    주문금액,
    수량
FROM 임시테이블 t
JOIN DW.고객차원 d ON t.고객ID = d.고객ID;
```

## 🎨 DW 모델링 접근법

### 1. 톱다운 접근법 (Inmon 방식)
```
특징:
- 전사적 관점에서 설계
- 정규화된 DW 구조
- 데이터 마트는 DW에서 추출

장점:
✅ 일관성 있는 전사 데이터
✅ 중복 최소화
✅ 확장성 우수

단점:
❌ 구축 기간 길음
❌ 초기 투자 비용 높음
❌ 복잡한 구조
```

### 2. 바텀업 접근법 (Kimball 방식)
```
특징:
- 비즈니스 프로세스별 설계
- 차원 모델링 중심
- 데이터 마트를 먼저 구축

장점:
✅ 빠른 구축 가능
✅ 사용자 친화적
✅ 점진적 확장

단점:
❌ 데이터 일관성 이슈
❌ 중복 가능성
❌ 통합 복잡성
```

### 3. 하이브리드 접근법
```
특징:
- 두 방식의 장점 결합
- 단계적 구축
- 유연한 아키텍처

구축 순서:
1단계: 핵심 데이터 마트 구축
2단계: DW 코어 구축  
3단계: 추가 데이터 마트 확장
4단계: 전사 통합 완성
```

## 💡 DW 설계 원칙

### 1. 비즈니스 프로세스 중심
```
설계 순서:
1. 비즈니스 프로세스 식별
   - 주문 처리 프로세스
   - 고객 관리 프로세스
   - 재고 관리 프로세스

2. 측정 지표 정의
   - 매출액, 수량, 이익률
   - 고객수, 재구매율, 이탈률
   - 재고회전율, 품절률

3. 차원 정의
   - 시간, 고객, 상품, 지역
   - 판매채널, 프로모션
```

### 2. 사용자 관점 우선
```
고려사항:
- 사용자가 이해하기 쉬운 구조
- 직관적인 네이밍
- 분석 패턴에 최적화된 설계
- 성능을 고려한 사전 집계

예시:
기술적 명칭: FACT_SALES_DTL
사용자 친화적: 일별매출상세
```

### 3. 확장성 고려
```
확장 고려사항:
- 새로운 데이터 소스 추가
- 새로운 분석 요구사항
- 데이터량 증가
- 사용자 수 증가

설계 방법:
- 유연한 차원 구조
- 확장 가능한 팩트 구조
- 표준화된 ETL 프레임워크
```

## 🚀 클라우드 DW의 등장

### 전통적 DW vs 클라우드 DW
```
전통적 DW:
- 온프레미스 하드웨어
- 고정된 용량
- 높은 초기 투자
- 복잡한 관리

클라우드 DW:
- 클라우드 서비스
- 탄력적 확장
- 사용량 기반 과금
- 관리형 서비스
```

### 주요 클라우드 DW 서비스
```
Amazon Redshift:
- AWS의 관리형 DW
- 컬럼형 저장
- 병렬 처리

Google BigQuery:
- 서버리스 DW
- 페타바이트 규모
- SQL 기반 분석

Snowflake:
- 클라우드 네이티브
- 컴퓨팅/스토리지 분리
- 멀티 클라우드 지원
```

## 🎯 DW 구축 성공 요인

### 기술적 요인
```
□ 적절한 아키텍처 선택
□ 효율적인 ETL 설계
□ 성능 최적화
□ 데이터 품질 관리
□ 보안 및 백업 체계
```

### 조직적 요인
```
□ 경영진의 지원
□ 명확한 비즈니스 목표
□ 사용자 참여
□ 충분한 예산과 인력
□ 변화 관리
```

### 운영적 요인
```
□ 지속적인 모니터링
□ 정기적인 성능 튜닝
□ 사용자 교육
□ 피드백 수집 및 반영
□ 점진적 개선
```

## 🎯 체크리스트: DW 개념 이해도

### 기본 개념
- [ ] DW의 4가지 특징을 설명할 수 있는가?
- [ ] 운영 시스템과 DW의 차이를 이해하는가?
- [ ] ETL 프로세스의 역할을 파악하는가?
- [ ] DW 아키텍처 구성요소를 알고 있는가?

### 설계 원칙
- [ ] 비즈니스 프로세스 중심 설계를 이해하는가?
- [ ] 사용자 관점의 중요성을 인식하는가?
- [ ] 확장성 고려사항을 파악하는가?
- [ ] 성능 최적화 방안을 알고 있는가?

---

**다음**: [4-3. 데이터 웨어하우스 아키텍처와 모델, 혼동하지 않기](./03-dw-architecture-vs-model.md)