# 4-1. 데이터 모델링과 데이터 웨어하우스 모델링, 어떻게 다른가 🏢

## 📖 학습 목표
- OLTP와 OLAP 시스템의 차이점 이해
- 데이터 웨어하우스 모델링의 특징 파악
- 두 모델링 접근법의 차이점 학습

## 🎯 두 개의 다른 세계

### 운영 시스템 (OLTP) vs 분석 시스템 (OLAP)
```
OLTP (Online Transaction Processing)
목적: 일상 업무 처리
특징: 빠른 트랜잭션, 정확한 데이터
예시: 주문 처리, 재고 관리, 고객 관리

OLAP (Online Analytical Processing)  
목적: 의사결정 지원
특징: 대용량 분석, 집계된 데이터
예시: 매출 분석, 트렌드 분석, 예측 모델
```

### 서점과 도서관의 비유
```
서점 (OLTP)              도서관 (OLAP)
─────────────────       ─────────────────
빠른 판매 처리      →    깊이 있는 연구
실시간 재고 관리    →    방대한 자료 보관
정확한 계산         →    다양한 관점 분석
개별 거래 중심      →    전체 패턴 파악
```

## 🔍 모델링 접근법의 차이

### 1. 설계 철학

#### OLTP 모델링 (정규화 중심)
```
철학: "데이터 중복을 최소화하라"

특징:
✅ 3정규형 이상 정규화
✅ 트랜잭션 무결성 중시
✅ 저장 공간 효율성
✅ 입력/수정/삭제 최적화

예시 구조:
고객 ──< 주문 ──< 주문상세 >── 상품
     1:N      1:N         N:1
```

#### OLAP 모델링 (비정규화 중심)
```
철학: "조회 성능을 최적화하라"

특징:
✅ 의도적 비정규화
✅ 조회 성능 중시  
✅ 사용자 편의성
✅ 집계 데이터 사전 계산

예시 구조:
     일자차원
        │
고객차원 ── 매출팩트 ── 상품차원
        │
     지역차원
```

### 2. 데이터 구조

#### OLTP: 엔티티-관계 모델
```sql
-- 정규화된 구조
CREATE TABLE 고객 (
    고객ID NUMBER PRIMARY KEY,
    고객명 VARCHAR(50),
    지역코드 VARCHAR(10)
);

CREATE TABLE 주문 (
    주문ID NUMBER PRIMARY KEY,
    고객ID NUMBER,
    주문일자 DATE,
    FOREIGN KEY (고객ID) REFERENCES 고객(고객ID)
);

-- 매출 조회 시 복잡한 조인 필요
SELECT c.지역코드, SUM(o.주문금액)
FROM 고객 c
JOIN 주문 o ON c.고객ID = o.고객ID
WHERE o.주문일자 BETWEEN '2024-01-01' AND '2024-12-31'
GROUP BY c.지역코드;
```

#### OLAP: 차원-팩트 모델
```sql
-- 비정규화된 구조 (스타 스키마)
CREATE TABLE 매출팩트 (
    일자키 NUMBER,
    고객키 NUMBER,
    상품키 NUMBER,
    지역키 NUMBER,
    매출금액 NUMBER,
    수량 NUMBER,
    할인금액 NUMBER
);

-- 매출 조회 시 단순한 집계
SELECT 지역명, SUM(매출금액)
FROM 매출팩트 f
JOIN 지역차원 r ON f.지역키 = r.지역키
WHERE f.일자키 BETWEEN 20240101 AND 20241231
GROUP BY 지역명;
```

### 3. 데이터 특성

#### OLTP 데이터
```
특성:
- 실시간 데이터
- 상세 수준 (Detail Level)
- 현재 상태 중심
- 트랜잭션별 데이터
- 정규화된 형태

예시:
주문ID: ORD001
고객ID: CU001  
상품ID: PRD001
수량: 2
단가: 15000
주문일시: 2024-01-15 14:30:25
```

#### OLAP 데이터
```
특성:
- 이력 데이터 (Historical)
- 집계 수준 (Summary Level)  
- 시간 시리즈 중심
- 분석용 데이터
- 비정규화된 형태

예시:
년월: 202401
지역: 서울
상품카테고리: 전자제품
총매출: 15,000,000
총수량: 1,250
평균단가: 12,000
```

## 📊 성능 최적화 전략

### OLTP 성능 최적화
```
전략:
1. 인덱스 최적화
   - 기본키, 외래키 인덱스
   - 조회 조건별 복합 인덱스
   
2. 정규화 유지
   - 데이터 중복 최소화
   - 무결성 제약조건 활용
   
3. 트랜잭션 최적화
   - 짧은 트랜잭션 유지
   - 락 경합 최소화

예시:
CREATE INDEX IDX_주문_고객ID_일자 
ON 주문(고객ID, 주문일자);
```

### OLAP 성능 최적화
```
전략:
1. 사전 집계 (Pre-Aggregation)
   - 월별, 분기별 요약 테이블
   - 큐브 구조 활용
   
2. 파티셔닝
   - 날짜별 파티션
   - 지역별 파티션
   
3. 컬럼형 저장
   - 압축률 향상
   - 집계 성능 최적화

예시:
CREATE TABLE 월별매출요약 (
    년월 NUMBER,
    지역코드 VARCHAR(10),
    총매출 NUMBER,
    총수량 NUMBER
) PARTITION BY RANGE (년월);
```

## 🎨 모델링 패턴 비교

### OLTP 패턴: 마스터-디테일
```
패턴 특징:
- 헤더-라인 구조
- 1:N 관계 중심
- 트랜잭션 단위 처리

예시:
주문 (마스터)
├── 주문ID
├── 고객ID  
├── 주문일자
└── 총금액

주문상세 (디테일)
├── 주문ID (FK)
├── 상품ID
├── 수량
└── 단가
```

### OLAP 패턴: 스타 스키마
```
패턴 특징:
- 중앙 팩트 + 주변 차원
- 비정규화 구조
- 분석 관점 중심

예시:
        일자차원
           │
고객차원 ── 매출팩트 ── 상품차원
           │
        지역차원

매출팩트 (중심)
├── 일자키 (FK)
├── 고객키 (FK)
├── 상품키 (FK)
├── 지역키 (FK)
├── 매출금액
└── 수량
```

## 🔄 데이터 흐름의 차이

### OLTP 데이터 흐름
```
사용자 입력 → 검증 → 저장 → 즉시 반영

특징:
- 실시간 처리
- 개별 트랜잭션
- 즉시 일관성
- 동시성 제어 중요

예시:
고객이 주문 → 재고 확인 → 주문 저장 → 재고 차감
```

### OLAP 데이터 흐름
```
운영DB → ETL → 데이터웨어하우스 → 분석

특징:
- 배치 처리
- 대량 데이터
- 최종 일관성
- 처리량 중요

예시:
일별 매출 → 집계 → DW 적재 → 월별 분석 리포트
```

## 💡 언제 어떤 모델링을 사용할까?

### OLTP 모델링 적용 영역
```
적용 대상:
✅ 업무 처리 시스템
✅ 실시간 트랜잭션
✅ 데이터 입력/수정 중심
✅ 정확성이 중요한 업무

예시:
- 주문 관리 시스템
- 재고 관리 시스템  
- 고객 관리 시스템
- 회계 시스템
```

### OLAP 모델링 적용 영역
```
적용 대상:
✅ 분석 및 리포팅 시스템
✅ 의사결정 지원 시스템
✅ 데이터 조회 중심
✅ 성능이 중요한 분석

예시:
- 매출 분석 시스템
- 고객 행동 분석
- 재무 분석 시스템
- 경영 대시보드
```

### 하이브리드 접근법
```
현실적 해결책:
- 운영계: OLTP 모델링
- 분석계: OLAP 모델링  
- ETL로 데이터 변환
- 목적별 최적화

아키텍처:
운영DB (OLTP) → ETL → DW (OLAP) → 분석도구
```

## 🎯 실무 적용 가이드

### 모델링 방식 선택 기준
```
OLTP 선택 기준:
□ 실시간 처리가 필요한가?
□ 데이터 입력/수정이 빈번한가?
□ 트랜잭션 무결성이 중요한가?
□ 개별 레코드 조회가 주요 패턴인가?

OLAP 선택 기준:
□ 대용량 데이터 분석이 필요한가?
□ 집계 및 요약 정보가 중요한가?
□ 다차원 분석이 필요한가?
□ 이력 데이터 분석이 중요한가?
```

### 성공적인 프로젝트를 위한 팁
```
1. 목적 명확화
   - 운영 목적 vs 분석 목적
   - 사용자 요구사항 정확한 파악
   
2. 단계적 접근
   - 운영계 먼저 구축
   - 분석계는 운영 안정화 후
   
3. 적절한 도구 선택
   - OLTP: 관계형 DB (Oracle, MySQL)
   - OLAP: 분석 DB (Snowflake, BigQuery)
   
4. 성능 모니터링
   - 각 시스템별 최적화 지표 관리
   - 지속적인 튜닝
```

## 🎯 체크리스트: 올바른 모델링 접근법 선택

### 요구사항 분석
- [ ] 시스템의 주요 목적이 명확한가?
- [ ] 사용자의 주요 업무 패턴을 파악했는가?
- [ ] 성능 요구사항이 정의되었는가?
- [ ] 데이터 특성을 분석했는가?

### 기술적 고려사항
- [ ] 적절한 DBMS를 선택했는가?
- [ ] 확장성을 고려했는가?
- [ ] 유지보수 방안이 있는가?
- [ ] 모니터링 체계가 준비되었는가?

---

**다음**: [4-2. 데이터 웨어하우스, 구름 타고 개념 잡기](./02-dw-concepts.md)