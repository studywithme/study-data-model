# 3-1. 데이터 모델링의 진수, 구조 설계에 대하여 🏗️

## 📖 학습 목표
- 데이터 구조 설계의 본질과 중요성 이해
- 좋은 구조 설계의 원칙 학습
- 구조 설계 시 고려사항 파악

## 🎯 구조 설계란 무엇인가?

### 정의
**데이터 구조 설계**는 비즈니스 요구사항을 만족하면서도 효율적이고 유지보수 가능한 데이터베이스 구조를 만드는 과정입니다.

### 건축과의 비유
```
건축 설계          데이터 구조 설계
─────────────────  ─────────────────
기초 공사     →    테이블 설계
기둥과 보     →    기본키와 외래키
방 배치       →    정규화
전기/배관     →    인덱스와 제약조건
인테리어     →    성능 최적화
```

## 🔍 구조 설계의 핵심 요소

### 1. 안정성 (Stability)
```
데이터 무결성 보장:
- 참조 무결성: 외래키 제약조건
- 도메인 무결성: 체크 제약조건  
- 엔티티 무결성: 기본키 제약조건
- 사용자 정의 무결성: 비즈니스 규칙
```

### 2. 확장성 (Scalability)
```
미래 변화 대응:
- 새로운 속성 추가 용이성
- 새로운 관계 정의 가능성
- 데이터량 증가 대응
- 성능 저하 최소화
```

### 3. 유연성 (Flexibility)
```
요구사항 변화 적응:
- 비즈니스 규칙 변경 대응
- 새로운 업무 프로세스 지원
- 시스템 통합 용이성
- 인터페이스 확장성
```

### 4. 성능 (Performance)
```
효율적인 데이터 처리:
- 조회 성능 최적화
- 입력/수정/삭제 성능
- 동시 사용자 지원
- 응답 시간 보장
```

## 🏛️ 구조 설계의 계층

### 1층: 개념적 구조
```
비즈니스 관점의 구조:
- 엔티티 식별
- 관계 정의
- 핵심 속성 도출
- 비즈니스 규칙 반영

예시: 고객-주문-상품의 기본 관계
```

### 2층: 논리적 구조
```
시스템 관점의 구조:
- 정규화 적용
- 속성 상세 정의
- 관계 구체화
- 제약조건 정의

예시: 3정규형까지 정규화된 테이블 구조
```

### 3층: 물리적 구조
```
구현 관점의 구조:
- 데이터 타입 결정
- 인덱스 설계
- 파티셔닝 적용
- 성능 최적화

예시: Oracle 데이터베이스의 실제 테이블
```

## 📐 좋은 구조 설계의 원칙

### 원칙 1: 단순성 (Simplicity)
```
❌ 복잡한 구조:
- 과도한 정규화로 인한 복잡한 조인
- 불필요한 중간 테이블 남발
- 이해하기 어려운 관계 구조

✅ 단순한 구조:
- 직관적인 테이블 관계
- 최소한의 조인으로 원하는 정보 획득
- 명확한 데이터 흐름
```

#### 실제 예시
```sql
-- 복잡한 구조 (과도한 정규화)
SELECT c.고객명, o.주문일자, p.상품명
FROM 고객 c
JOIN 주문 o ON c.고객ID = o.고객ID
JOIN 주문상세 od ON o.주문ID = od.주문ID
JOIN 상품 p ON od.상품ID = p.상품ID
JOIN 상품카테고리 pc ON p.카테고리ID = pc.카테고리ID
JOIN 카테고리 cat ON pc.카테고리ID = cat.카테고리ID;

-- 단순한 구조 (적절한 비정규화)
SELECT c.고객명, o.주문일자, od.상품명, od.카테고리명
FROM 고객 c
JOIN 주문 o ON c.고객ID = o.고객ID
JOIN 주문상세 od ON o.주문ID = od.주문ID;
```

### 원칙 2: 일관성 (Consistency)
```
명명 규칙 일관성:
- 테이블명: 단수형, 한글 사용
- 기본키: [테이블명]ID 형태
- 외래키: 참조 테이블의 기본키명과 동일
- 날짜: 일자, 일시 구분

데이터 타입 일관성:
- ID: VARCHAR(10) 통일
- 금액: NUMBER(15,2) 통일
- 날짜: DATE 타입 통일
```

### 원칙 3: 완전성 (Completeness)
```
비즈니스 요구사항 완전 반영:
- 모든 업무 프로세스 지원
- 필요한 모든 정보 저장
- 비즈니스 규칙 완전 구현
- 예외 상황 처리 방안 포함
```

### 원칙 4: 최소성 (Minimality)
```
불필요한 요소 제거:
- 중복 데이터 최소화
- 사용하지 않는 속성 제거
- 복잡한 관계 단순화
- 과도한 인덱스 방지
```

## 🎨 구조 설계 패턴

### 패턴 1: 마스터-디테일 패턴
```
용도: 헤더-라인 형태의 데이터
구조: 1:N 관계

예시:
주문 (마스터)
├── 주문ID (PK)
├── 고객ID
├── 주문일자
└── 총금액

주문상세 (디테일)  
├── 주문상세ID (PK)
├── 주문ID (FK)
├── 상품ID
├── 수량
└── 단가
```

### 패턴 2: 계층 구조 패턴
```
용도: 조직도, 카테고리 등 계층 데이터
구조: 자기 참조 관계

예시:
부서
├── 부서ID (PK)
├── 부서명
├── 상위부서ID (FK → 부서.부서ID)
└── 부서레벨
```

### 패턴 3: 다대다 해결 패턴
```
용도: M:N 관계 해결
구조: 연결 테이블 사용

예시:
학생 ←→ 수강 ←→ 과목

수강 (연결 테이블)
├── 수강ID (PK)
├── 학생ID (FK)
├── 과목ID (FK)
├── 수강일자
└── 성적
```

### 패턴 4: 이력 관리 패턴
```
용도: 데이터 변경 이력 추적
구조: 시간 차원 추가

예시:
고객이력
├── 이력ID (PK)
├── 고객ID
├── 고객명
├── 연락처
├── 적용시작일자
├── 적용종료일자
└── 변경사유
```

## 🔧 구조 설계 프로세스

### 1단계: 요구사항 분석
```
수집 항목:
□ 업무 프로세스 흐름
□ 입력/출력 데이터 명세
□ 비즈니스 규칙
□ 성능 요구사항
□ 보안 요구사항
□ 통합 요구사항
```

### 2단계: 개념적 설계
```
작업 내용:
□ 핵심 엔티티 식별
□ 엔티티 간 관계 정의
□ 주요 속성 도출
□ 비즈니스 규칙 반영
□ 개념적 ERD 작성
```

### 3단계: 논리적 설계
```
작업 내용:
□ 정규화 적용 (1NF → 2NF → 3NF)
□ 모든 속성 상세 정의
□ 도메인 정의
□ 제약조건 정의
□ 논리적 ERD 작성
```

### 4단계: 물리적 설계
```
작업 내용:
□ 데이터 타입 결정
□ 인덱스 설계
□ 파티셔닝 검토
□ 성능 최적화
□ 물리적 ERD 작성
```

### 5단계: 검토 및 최적화
```
검토 항목:
□ 비즈니스 요구사항 만족도
□ 성능 요구사항 만족도
□ 표준 준수 여부
□ 확장성 및 유연성
□ 유지보수 용이성
```

## 💡 구조 설계 시 주의사항

### 주의사항 1: 과도한 정규화 지양
```
문제점:
- 복잡한 조인으로 인한 성능 저하
- 이해하기 어려운 구조
- 개발 복잡도 증가

해결책:
- 비즈니스 요구사항에 맞는 적절한 수준의 정규화
- 성능이 중요한 부분은 의도적 비정규화 고려
- 조회 패턴을 고려한 구조 설계
```

### 주의사항 2: 미래 확장성 고려
```
고려사항:
- 새로운 속성 추가 가능성
- 새로운 관계 정의 필요성
- 데이터량 증가 대응 방안
- 새로운 업무 프로세스 지원

설계 방법:
- 확장 가능한 구조 설계
- 예약 필드 고려 (단, 남용 금지)
- 유연한 관계 정의
- 성능 확장 방안 사전 검토
```

### 주의사항 3: 성능과 정규화의 균형
```
성능 우선 영역:
- 대용량 데이터 처리
- 실시간 응답이 필요한 업무
- 복잡한 집계 연산
- 배치 처리 업무

정규화 우선 영역:
- 데이터 일관성이 중요한 업무
- 트랜잭션 처리 업무
- 마스터 데이터 관리
- 실시간 입력 업무
```

## 🎯 체크리스트: 좋은 구조 설계인가?

### 기능적 측면
- [ ] 모든 비즈니스 요구사항을 만족하는가?
- [ ] 비즈니스 규칙이 정확히 반영되었는가?
- [ ] 예외 상황 처리가 가능한가?
- [ ] 필요한 모든 정보를 제공할 수 있는가?

### 기술적 측면
- [ ] 데이터 무결성이 보장되는가?
- [ ] 성능 요구사항을 만족하는가?
- [ ] 확장성과 유연성을 고려했는가?
- [ ] 표준과 규칙을 준수했는가?

### 관리적 측면
- [ ] 이해하기 쉬운 구조인가?
- [ ] 유지보수가 용이한가?
- [ ] 문서화가 충분한가?
- [ ] 변경 영향도가 최소화되는가?

---

**다음**: [3-2. 데이터 구성도, 전체 데이터를 한눈에 조망하기](./02-data-architecture-diagram.md)